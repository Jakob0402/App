<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Foto â†’ Barcode â†’ ISBN</title>
<style>
body { font-family: Arial; text-align: center; padding: 20px; }
video, img { width: 90%; max-width: 400px; margin-top: 10px; }
button { padding: 12px 20px; font-size: 18px; margin-top: 15px; }
#book-info { margin-top: 25px; border: 1px solid #ccc; padding: 15px; }
</style>
</head>
<body>

<h2>ðŸ“¸ Foto aufnehmen</h2>

<video id="video" autoplay playsinline></video>
<button id="captureBtn">ðŸ“· Foto aufnehmen</button>

<canvas id="canvas" style="display:none;"></canvas>

<div id="book-info"></div>

<script>
/* Buchdaten empfangen */
const params = new URLSearchParams(window.location.search);
if (params.get("title")) {
    document.getElementById("book-info").innerHTML = `
        <h3>ðŸ“š Buchdaten</h3>
        <p><b>Titel:</b> ${params.get("title")}</p>
        <p><b>Autor:</b> ${params.get("author")}</p>
        <p><b>Erscheinungsjahr:</b> ${params.get("year")}</p>
        <p><b>ISBN:</b> ${params.get("isbn")}</p>
    `;
}

/* Kamera starten */
navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
    .then(stream => video.srcObject = stream);

/* Foto aufnehmen */
document.getElementById("captureBtn").addEventListener("click", () => {
    const canvas = document.getElementById("canvas");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    const ctx = canvas.getContext("2d");
    ctx.drawImage(video, 0, 0);

    const imageData = canvas.toDataURL("image/png");

    window.location.href = "scanner.html?img=" + encodeURIComponent(imageData);
});
</script>

</body>
</html>
